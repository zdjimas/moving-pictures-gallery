<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Abstracts, Tools and Ghouls — Virtual Museum Room</title>
<style>
  :root{
    --bg1:#0e1014; --bg2:#151821; --accentGlow: rgba(160,160,180,.12);
    --ink:#e9ecf2; --muted:#b7bfcc;
    --frame:#11161c; --mat:#0f141b; --mat-edge:#27303a;
    --pl-shadow: 0 10px 30px rgba(0,0,0,.38);
    --tile-shadow: 0 20px 40px rgba(0,0,0,.38);
  }

  /* Room themes */
  .theme-gold{
    --bg1:#111319; --bg2:#171a22; --accentGlow: rgba(210,180,120,.10);
  }
  .theme-ebony{
    --bg1:#0c0e12; --bg2:#12151b; --accentGlow: rgba(120,140,180,.10);
    --frame:#0a0d12; --mat:#0d1218; --mat-edge:#1f2630;
  }

  *{ box-sizing: border-box }
  html,body{ height:100% }
  body{
    margin:0; color:var(--ink);
    font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    background:
      radial-gradient(900px 600px at 78% 14%, var(--accentGlow), transparent 62%),
      radial-gradient(900px 650px at 18% 82%, var(--accentGlow), transparent 66%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    min-height: 100svh;
  }

  header{ text-align:center; padding:28px 16px 12px }
  h1{ margin:0; font-size: clamp(22px,3.4vw,36px) }
  .sub{ margin:6px 0 0; color:var(--muted) }

  .actions{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin:16px 0 28px }
  .btn, .linkbtn, .select{
    background:#0f141b; color:#e9ecf2; border:1px solid #2a3340;
    padding:10px 14px; border-radius:10px; font-size:.95rem; cursor:pointer; text-decoration:none;
  }
  .btn:hover, .linkbtn:hover{ background:#151b24 }
  .select{ appearance:none }

  .shell{ max-width: 1200px; margin: 0 auto; padding: 0 18px 80px }

  .cards{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(620px, 1fr));
    gap: 42px;
  }
  .card{
    --mediaW: 420px; --plaqueW: 220px; --plaqueTop: 14px;
    --pl-pad-left: 0px; --pl-pad-right: 0px;
    position: relative;
    padding-left:  var(--pl-pad-left);
    padding-right: var(--pl-pad-right);
  }
  .artwrap{ max-width: var(--mediaW); margin: 0 auto; }

  .frame{
    --tilt: 0deg;
    display:block; position:relative; cursor:pointer;
    border:12px solid var(--frame); border-radius: 20px;
    background: linear-gradient(180deg, #0c1218, #141c24);
    box-shadow: var(--tile-shadow), 0 0 0 1px rgba(255,255,255,.05) inset;
    transition: transform .20s ease, box-shadow .20s ease;
    overflow:hidden; transform: rotate(var(--tilt)); text-decoration:none;
  }
  .frame::before{
    content:""; position:absolute; inset:8px; border-radius:14px;
    background: radial-gradient(120% 130% at 50% 50%, var(--mat) 0%, #0e151c 58%);
    box-shadow: inset 0 0 0 1px var(--mat-edge), inset 0 10px 20px rgba(0,0,0,.45);
  }
  .frame:hover{ transform: rotate(var(--tilt)) translateY(-2px) scale(1.01); box-shadow: 0 24px 58px rgba(0,0,0,.55), 0 0 0 1px rgba(255,255,255,.06) inset }

  .tile{ position:relative; aspect-ratio: var(--ar, 4/3); border-radius:12px; overflow:hidden; margin:12px; z-index:1 }
  .tile img{ width:100%; height:100%; display:block; object-fit:contain; object-position:center; background:#0d1319; transition: transform .25s ease; }

  /* Shapes */
  .shape-a .frame{ border-radius:28px }
  .shape-a .frame::before, .shape-a .tile{ border-radius:22px }
  .shape-b .frame{ border-radius:14px 28px 18px 32px }
  .shape-b .frame::before, .shape-b .tile{ border-radius:10px 22px 14px 26px }
  .shape-c .frame{ border-radius:40px }
  .shape-c .frame::before, .shape-c .tile{ border-radius:30px }
  .shape-d .frame{ border-radius:18px; }
  .shape-d .frame::before{ box-shadow: inset 0 0 0 2px rgba(255,255,255,.06), inset 0 20px 24px rgba(0,0,0,.5) }
  .shape-e .frame{ border-radius:18px 18px 48px 18px }
  .shape-e .frame::before, .shape-e .tile{ border-radius:12px 12px 36px 12px }
  .shape-f .frame{ border-radius:22px; }

  /* Finishes */
  .finish-gilded .frame{
    border:12px solid transparent;
    background:
      linear-gradient(180deg,#0e141a,#151d24) padding-box,
      conic-gradient(from 22deg,
        #6b4e0f, #caa54b 12%, #ffeb9c 24%, #d3ab4a 36%,
        #6b4e0f 48%, #e2c266 60%, #fff1b5 72%, #c3972e 84%, #6b4e0f) border-box;
    box-shadow: var(--tile-shadow), 0 10px 26px rgba(250,210,120,.16);
  }
  .finish-brass .frame{
    border:10px solid transparent;
    background:
      linear-gradient(180deg,#0e141a,#151d24) padding-box,
      conic-gradient(from -30deg,#3c2e14,#b49352,#6f582b,#d7b778,#4a3a18,#b49352) border-box;
    filter: saturate(1.06);
  }
  .finish-ebony .frame{
    border-color:#0a0d12;
    background:
      linear-gradient(180deg,#0a0f14,#131a22) padding-box,
      linear-gradient(145deg, #1c232c, #090d12 60%, #1a212a) border-box;
    box-shadow: var(--tile-shadow), 0 12px 28px rgba(0,0,0,.62);
  }
  .finish-walnut .frame{
    border:10px solid transparent;
    background:
      linear-gradient(180deg,#0e141a,#151d24) padding-box,
      linear-gradient(25deg, #3b2414 0%, #5a3820 30%, #7a4b2b 55%, #4b2d19 80%, #3b2414 100%) border-box;
    box-shadow: var(--tile-shadow), 0 10px 26px rgba(80,40,20,.35);
  }

  /* Plaques */
  .plaque{
    position:absolute; top: var(--plaqueTop); width: var(--plaqueW);
    z-index:2; padding:12px 14px; border-radius:12px; line-height:1.35;
    box-shadow: var(--pl-shadow); backdrop-filter: blur(2px);
    transform: rotate(var(--pl-tilt, 0deg));
  }
  .plaque::before{
    content:""; position:absolute; top:8px; width:8px; height:8px; border-radius:50%;
    background:#d0d0d0; box-shadow:0 1px 0 rgba(0,0,0,.5);
  }
  .pl-left  .plaque{ left:18px }  .pl-left  .plaque::before{ left:10px }
  .pl-right .plaque{ right:18px }  .pl-right .plaque::before{ right:10px }

  .pl-brass{ background: linear-gradient(180deg, #3b2f19, #7c6334); color:#f8f0d0; border:1px solid #c9b073 }
  .pl-ivory{ background: linear-gradient(180deg, #f6f1e3, #e6dcc6); color:#2a2a2a; border:1px solid #e1d4b6 }
  .pl-slate{ background: linear-gradient(180deg, #1d242c, #12171d); color:#dbe7ff; border:1px solid #2d3946 }
  .pl-verdigris{ background: linear-gradient(180deg, #0f2f2f, #0b2223); color:#d8fff6; border:1px solid #1e5a59 }
  .pl-wood{ background: linear-gradient(180deg, #4b2f1c, #352113); color:#ffe8c9; border:1px solid #6a4126 }

  .plaque h3{ margin:0 0 6px; font-size:1.02rem }
  .plaque .sub{ margin:0 0 10px; font-size:.9rem; opacity:.85 }
  .plaque p{ margin:0; font-size:.95rem }

  /* Narrow screens */
  @media (max-width: 860px){
    .cards{ grid-template-columns: 1fr }
    .card{ padding-left:0; padding-right:0 }
    .plaque{ position:static; width:auto; transform:none; margin:12px auto 0 }
    .plaque::before{ display:none }
    .artwrap{ max-width: min(92vw, 520px) }
  }

  .missing{
    position:absolute; inset:8px; display:grid; place-items:center;
    border:2px dashed #ff9a9a; color:#ffd0d0; background:#2a2f3a;
    border-radius:12px; font-size:.9rem; text-align:center; padding:8px;
  }
</style>
</head>
<body class="theme-gold">
  <header>
    <h1>Abstracts, Tools and Ghouls</h1>
    <p class="sub">Darker, rebellious works. Click any frame to open on TikTok in a new tab.</p>
    <div class="actions">
      <a class="linkbtn" href="../index.html">← Return to Lobby Map</a>
      <label for="themeSelect" class="visually-hidden" style="position:absolute;left:-9999px;">Room Theme</label>
      <select id="themeSelect" class="select" title="Room Theme">
        <option value="theme-gold" selected>Gold Frames on Charcoal</option>
        <option value="theme-ebony">Ebony Frames on Graphite</option>
      </select>
      <button id="shuffleBtn" class="btn" title="Randomize frame styles">Shuffle Frames</button>
    </div>
  </header>

  <div class="shell">
    <div id="cards" class="cards" aria-live="polite"></div>
  </div>

<script>
/* ============================
   ROOM CONTENT (order-mapped)
   ============================ */
/* Posters folder for THIS room */
const IMG_DIR = 'img/';

/* Your URLs (1→15) matched to titles/posters (1→15) */
const TIKTOKS = [
  "https://www.tiktok.com/t/ZT6TpD6Po/",
  "https://www.tiktok.com/t/ZT6TpSQUq/",
  "https://www.tiktok.com/t/ZT6TpDtSW/",
  "https://www.tiktok.com/t/ZT6TpYSjD/",
  "https://www.tiktok.com/t/ZT6TpSTgs/",
  "https://www.tiktok.com/t/ZT6Tp5T8L/",
  "https://www.tiktok.com/t/ZT6Tp2Jo5/",
  "https://www.tiktok.com/t/ZT6Tpa7ao/",
  "https://www.tiktok.com/t/ZT6TpAgJq/",
  "https://www.tiktok.com/t/ZT6TpMLgL/",
  "https://www.tiktok.com/t/ZT6TpMGT3/",
  "https://www.tiktok.com/t/ZT6TpH64F/",
  "https://www.tiktok.com/t/ZT6TpD8Vx/",
  "https://www.tiktok.com/t/ZT6Tp6sRb/",
  "https://www.tiktok.com/t/ZT6TpR367/"
];

/* Titles + posters (1→15), exactly aligned with the URLs above */
const MAPPINGS = [
  { title: "Vicarious and living",           poster: "vicarious.png" },
  { title: "Flood",                           poster: "flood.png" },
  { title: "Strangest of Days",               poster: "Strange.jpg" },
  { title: "Schism",                          poster: "schism.png" },
  { title: "Running from Waiting Worms",      poster: "Running.png" },
  { title: "The Resurrection of Fear",        poster: "fear.png" },
  { title: "46 & 3",                          poster: "463.png" },
  { title: "Resurrecting a Madman",           poster: "madman.png" },
  { title: "Another Brick, just one more….",  poster: "brick.png" },
  { title: "Symmetry of Collapse",            poster: "Collapse.png" },
  { title: "Bending the Clock",               poster: "clock.png" },
  { title: "Aenema Reborn",                   poster: "reborn.png" },
  { title: "Part of Me",                      poster: "part.png" },
  { title: "Pigs, 3 Different Illustrated",   poster: "pigs.png" },
  { title: "A Trippy Nightmare Remembered",   poster: "Nightmare.png" }
];

/* Build ITEMS by zipping the two lists in order */
const ITEMS = MAPPINGS.map((m,i)=>({
  title: m.title,
  poster: m.poster,
  tiktok: TIKTOKS[i]
}));

/* ============================
   RENDERING & BEHAVIOR
   ============================ */
const cardsEl = document.getElementById('cards');
const themeSelect = document.getElementById('themeSelect');
const shuffleBtn  = document.getElementById('shuffleBtn');

const rand   = (min,max)=> Math.random()*(max-min)+min;
const choose = arr => arr[Math.floor(Math.random()*arr.length)];

function installSmartFallback(img, rawPath){
  const [base, ext] = rawPath.split(/\.(?=[^.]+$)/);
  const toggled = ext === 'png' ? 'PNG' : ext === 'PNG' ? 'png' : null;
  const encoded = rawPath.replace(/ /g,'%20');
  const tries = [rawPath];
  if (toggled) tries.push(`${base}.${toggled}`);
  if (encoded !== rawPath) tries.push(encoded);
  let i=0;
  img.addEventListener('error', ()=>{ i+=1; if(i<tries.length) img.src = tries[i]; });
}

/* Per-tile varieties */
const SHAPES   = ['shape-a','shape-b','shape-c','shape-d','shape-e','shape-f'];
const FINISHES = ['finish-gilded','finish-ebony','finish-brass','finish-walnut'];
const PLAQUE_FINISHES = ['pl-brass','pl-ivory','pl-slate','pl-verdigris','pl-wood'];
const PLAQUE_SIDE     = ['pl-left','pl-right'];

/* Escape HTML for safe insertion */
function esc(s){ return String(s)
  .replace(/&/g,'&amp;').replace(/</g,'&lt;')
  .replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

/* Build one TikTok card */
function buildCard(item){
  const article = document.createElement('article');
  const side = choose(PLAQUE_SIDE);

  // Random layout within safe bounds
  const mediaW    = Math.round(rand(360, 460));
  const plaqueW   = Math.round(rand(180, 260));
  const plaqueTop = Math.round(rand(8, 46));
  const tilt      = rand(-0.30, 0.30).toFixed(3) + 'deg';
  const plTilt    = rand(-0.4, 0.4).toFixed(3) + 'deg';

  article.className = `card ${side} ${choose(SHAPES)} ${choose(FINISHES)}`;
  article.style.setProperty('--mediaW',  mediaW+'px');
  article.style.setProperty('--plaqueW', plaqueW+'px');
  article.style.setProperty('--plaqueTop', plaqueTop+'px');
  if (side === 'pl-left')  article.style.setProperty('--pl-pad-left',  `calc(var(--plaqueW) + 24px)`);
  if (side === 'pl-right') article.style.setProperty('--pl-pad-right', `calc(var(--plaqueW) + 24px)`);

  const title = item.title || '';
  const url   = item.tiktok;
  const file  = item.poster;
  const src   = IMG_DIR + file;

  article.innerHTML = `
    <div class="artwrap">
      <a class="frame" href="${url}" target="_blank" rel="noopener" data-title="${esc(title)}" style="--tilt:${tilt}">
        <div class="tile"><img alt="${esc(title)}" decoding="async" loading="lazy"></div>
      </a>
    </div>
    <aside class="plaque ${choose(PLAQUE_FINISHES)}" style="--pl-tilt:${plTilt}">
      <h3>${esc(title)}</h3>
      <p class="sub"><strong>Abstracts, Tools and Ghouls</strong> · <code>${esc(file)}</code></p>
      <p>Click to view on TikTok.</p>
    </aside>
  `;

  const img  = article.querySelector('img');
  const tile = article.querySelector('.tile');

  installSmartFallback(img, src);

  img.addEventListener('load', ()=>{
    const w = img.naturalWidth  || 4;
    const h = img.naturalHeight || 3;
    tile.style.setProperty('--ar', `${w} / ${h}`);
  });

  img.addEventListener('error', ()=>{
    if (img._failed) return;
    img._failed = true;
    const box = document.createElement('div');
    box.className = 'missing';
    box.innerHTML = 'Missing poster:<br><small><code>'+ (img.currentSrc || src) +'</code></small>';
    tile.appendChild(box); img.style.display='none';
  });

  img.src = src;
  return article;
}

function renderCards(){
  cardsEl.innerHTML = '';
  ITEMS.forEach(it => cardsEl.appendChild(buildCard(it)));
}

themeSelect.addEventListener('change', ()=>{
  document.body.classList.remove('theme-gold','theme-ebony');
  document.body.classList.add(themeSelect.value);
});

document.body.classList.add('theme-gold');  // default theme
document.getElementById('shuffleBtn').addEventListener('click', renderCards);

renderCards();
</script>
</body>
</html>

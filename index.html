
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title> Moving Pictures Gallery of art and music works from Chris J. Murphy â€” 2Ã—2 Gallery (Hover with Sound Toggle)</title>
  <style>
    :root { --bg:#0b0c10; --card:#121317; --text:#e8eaed; --muted:#9aa0a6; --accent:#7cc6ff; --radius:18px; --shadow:0 10px 30px rgba(0,0,0,.35); }
    html,body { height:100% }
    body { margin:0; background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; }
    .wrap { max-width:1100px; margin:auto; padding:28px 18px 80px }
    h1 { margin:0 0 8px; font-size:clamp(22px,2.6vw,34px) }
    .note { color:var(--muted); font-size:14px; margin:6px 0 16px }

    /* Controls */
    .controls { display:flex; gap:10px; flex-wrap:wrap; margin:8px 0 18px }
    .btn { appearance:none; border:1px solid #2a2f3a; background:#171a21; color:var(--text); padding:10px 14px; border-radius:10px; cursor:pointer; box-shadow:var(--shadow) }
    .btn[aria-pressed="true"] { border-color:#3a84ff; background:#1b2436 }

    /* 2Ã—2 grid (collapses to 1 column on small screens) */
    .gallery {
      display:grid;
      grid-template-columns: repeat(2, minmax(280px, 1fr));
      gap:18px;
    }
    @media (max-width: 720px) {
      .gallery { grid-template-columns: 1fr; }
    }

    .tile { position:relative; background:var(--card); border-radius:var(--radius); overflow:hidden; box-shadow:var(--shadow); }
    .thumb, .clip { display:block; width:100%; height:100%; object-fit:cover }
    .clip { position:absolute; inset:0; opacity:0; transition:opacity .25s ease-out }
    .tile:hover .clip, .tile:focus-within .clip { opacity:1 }

    .overlay { position:absolute; inset:auto 0 0 0; background:linear-gradient(180deg, transparent, rgba(0,0,0,.75)); padding:12px 14px; display:flex; align-items:center; justify-content:space-between; gap:10px }
    .title { font-weight:600; font-size:14px }
    .badge { font-size:12px; color:#c5e4ff; background:rgba(124,198,255,.08); border:1px solid rgba(124,198,255,.3); padding:4px 8px; border-radius:999px }

    /* Lightbox */
    .lightbox { position:fixed; inset:0; background:rgba(8,10,14,.72); backdrop-filter:blur(6px); display:none; align-items:center; justify-content:center; padding:24px; z-index:50 }
    .lightbox.open { display:flex }
    .lightbox-card { width:min(1100px,92vw); background:#0f1218; border:1px solid #222936; border-radius:20px; overflow:hidden; box-shadow:var(--shadow) }
    .lightbox-head { display:flex; justify-content:space-between; align-items:center; padding:12px 16px; border-bottom:1px solid #1b222e }
    .lightbox-title { font-weight:600 }
    .x { border:0; background:transparent; color:#9aa0a6; font-size:22px; cursor:pointer }
    .player { position:relative; aspect-ratio:16/9; background:#000 }
    .player video { position:absolute; inset:0; width:100%; height:100%; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Moving Pictures â€” Gallery</h1>
    <div class="note">Hover to preview. Click to open with sound. Use the button to allow sound during hover previews.</div>

    <div class="controls">
      <button id="soundToggle" class="btn" aria-pressed="false">ðŸ”Š Enable Sound Previews</button>
      <button class="btn" onclick="location.reload()">â†» Refresh</button>
    </div>

    <div class="gallery">
      <!-- Tile 1 -->
      <article class="tile" tabindex="0"
               data-title="Xavier's Perspectives"
               data-video="./xaviers-perspectives.mp4">
        <img class="thumb" src="./xaviers-perspectives-poster.png" alt="Poster: Xavier's Perspectives" />
        <video class="clip" preload="none" playsinline muted loop></video>
        <div class="overlay">
          <div class="title">Xavier's Perspectives</div>
          <div class="badge">Hover to preview</div>
        </div>
      </article>

      <!-- Tile 2 -->
      <article class="tile" tabindex="0"
               data-title="Reflections from a Jazz Club"
               data-video="./Reflections from a Jazz Club.mp4">
        <img class="thumb" src="./Jazz.png" alt="Poster: Reflections from a Jazz Club" />
        <video class="clip" preload="none" playsinline muted loop></video>
        <div class="overlay">
          <div class="title">Reflections from a Jazz Club</div>
          <div class="badge">Hover to preview</div>
        </div>
      </article>

      <!-- Tile 3 -->
      <article class="tile" tabindex="0"
               data-title="Vacancy â€” an AI cover of Dream Theater"
               data-video="./Vacancy - an AI cover of Dream Theater.mp4">
        <img class="thumb" src="./Vacancy.png" alt="Poster: Vacancy â€” an AI cover of Dream Theater" />
        <video class="clip" preload="none" playsinline muted loop></video>
        <div class="overlay">
          <div class="title">Vacancy â€” AI cover (Dream Theater)</div>
          <div class="badge">Hover to preview</div>
        </div>
      </article>

      <!-- Tile 4 -->
      <article class="tile" tabindex="0"
               data-title="Wings for Marie"
               data-video="./Wings For Marie.mp4">
        <img class="thumb" src="./Wings.png" alt="Poster: Wings for Marie" />
        <video class="clip" preload="none" playsinline muted loop></video>
        <div class="overlay">
          <div class="title">Wings for Marie</div>
          <div class="badge">Hover to preview</div>
        </div>
      </article>
    </div>
  </div>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-label="Video player">
    <div class="lightbox-card">
      <div class="lightbox-head">
        <div class="lightbox-title" id="lbTitle">Title</div>
        <button class="x" id="lbClose" aria-label="Close">âœ•</button>
      </div>
      <div class="player">
        <video id="lbVideo" controls playsinline></video>
      </div>
    </div>
  </div>

  <script>
    /* ===========
       Sound opt-in for hover previews
       =========== */
    let soundEnabled = false;
    let audioCtx = null;
    const soundToggle = document.getElementById('soundToggle');
    soundToggle.addEventListener('click', async () => {
      try {
        audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();
        if (audioCtx.state === 'suspended') await audioCtx.resume();
      } catch(e) { /* ignore; the click itself is enough for many browsers */ }
      soundEnabled = !soundEnabled;
      soundToggle.setAttribute('aria-pressed', String(soundEnabled));
      soundToggle.textContent = soundEnabled ? 'ðŸ”‡ Disable Sound Previews' : 'ðŸ”Š Enable Sound Previews';
    });

    /* ===========
       Hover/touch preview (full video, loops)
       =========== */
    const tiles = document.querySelectorAll('.tile');

    function startPreview(tile) {
      const v = tile.querySelector('video.clip');
      if (!v.src) v.src = tile.dataset.video;  // lazy load
      v.muted = !soundEnabled;                 // unmute after opt-in
      v.loop = true;                           // keep playing full video
      v.play().catch(()=>{ /* autoplay may still be blocked in some setups */ });
    }
    function stopPreview(tile) {
      const v = tile.querySelector('video.clip');
      if (v) { v.pause(); } // keep current frame; set v.currentTime=0 if you prefer rewind
    }

    tiles.forEach(tile => {
      // Desktop hover/focus
      tile.addEventListener('mouseenter', () => startPreview(tile));
      tile.addEventListener('focus', () => startPreview(tile));
      tile.addEventListener('mouseleave', () => stopPreview(tile));
      tile.addEventListener('blur', () => stopPreview(tile));

      // Mobile/iPad: treat touch as hover
      tile.addEventListener('touchstart', () => startPreview(tile), {passive:true});
      tile.addEventListener('touchend', () => stopPreview(tile), {passive:true});
    });

    /* ===========
       Lightbox with sound
       =========== */
    const lb = document.getElementById('lightbox');
    const lbVideo = document.getElementById('lbVideo');
    const lbTitle = document.getElementById('lbTitle');
    const lbClose = document.getElementById('lbClose');

    function openLightbox(title, src, poster) {
      lbTitle.textContent = title || 'Untitled';
      lbVideo.src = src;
      lbVideo.poster = poster || '';
      lb.classList.add('open');
      // User will press Play; complies with iOS audio policy
      lbVideo.muted = false;
    }
    function closeLightbox() {
      lbVideo.pause();
      lbVideo.src = '';
      lb.classList.remove('open');
    }
    lbClose.addEventListener('click', closeLightbox);
    lb.addEventListener('click', (e) => { if (e.target === lb) closeLightbox(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && lb.classList.contains('open')) closeLightbox(); });

    tiles.forEach(tile => {
      tile.addEventListener('click', () =>
        openLightbox(
          tile.dataset.title,
          tile.dataset.video,
          tile.querySelector('img.thumb')?.getAttribute('src')
        )
      );
      tile.addEventListener('keyup', (e) => {
        if (e.key === 'Enter' || e.key === ' ')
          openLightbox(
            tile.dataset.title,
            tile.dataset.video,
            tile.querySelector('img.thumb')?.getAttribute('src')
          );
      });
    });
  </script>
</body>
</html>

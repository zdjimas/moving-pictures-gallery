<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Moving Pictures â€” Virtual Gallery</title>
  <style>
    :root { --bg:#0b0c10; --card:#121317; --text:#e8eaed; --muted:#9aa0a6; --accent:#7cc6ff; --shadow:0 10px 30px rgba(0,0,0,.35); --radius:18px; }
    html,body { height:100% }
    body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:#0b0c10; color:#e8eaed; }
    .wrap { max-width:1200px; margin:auto; padding:32px 20px 80px }
    header { display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:22px }
    h1 { font-size:clamp(24px,2.4vw,36px); margin:0 }
    .note { color:var(--muted); font-size:14px }
    .btn { appearance:none; border:1px solid #2a2f3a; background:#171a21; color:var(--text); padding:10px 14px; border-radius:10px; cursor:pointer; box-shadow:var(--shadow) }
    .btn:hover { border-color:#3a4252; background:#1d212a }
    .controls { display:flex; gap:10px; flex-wrap:wrap }
    .gallery { display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:18px }
    .tile { position:relative; background:var(--card); border-radius:var(--radius); overflow:hidden; box-shadow:var(--shadow) }
    .thumb, .clip { display:block; width:100%; height:100%; object-fit:cover }
    .clip { position:absolute; inset:0; opacity:0; transition:opacity .25s ease-out }
    .tile:hover .clip, .tile:focus-within .clip { opacity:1 }
    .overlay { position:absolute; inset:auto 0 0 0; background:linear-gradient(180deg,rgba(0,0,0,0) 0%, rgba(0,0,0,.7) 100%); padding:12px 14px; display:flex; align-items:center; justify-content:space-between; gap:10px }
    .title { font-weight:600; font-size:14px }
    .badge { font-size:12px; color:#c5e4ff; background:rgba(124,198,255,.08); border:1px solid rgba(124,198,255,.3); padding:4px 8px; border-radius:999px }
    .lightbox { position:fixed; inset:0; backdrop-filter:blur(6px); background: rgba(8,10,14,.72); display:none; align-items:center; justify-content:center; padding:24px; z-index:50 }
    .lightbox.open { display:flex }
    .lightbox-card { width:min(1100px,92vw); background:#0f1218; border:1px solid #222936; border-radius:20px; overflow:hidden; box-shadow:var(--shadow) }
    .lightbox-head { display:flex; justify-content:space-between; align-items:center; padding:12px 16px; border-bottom:1px solid #1b222e }
    .lightbox-title { font-weight:600 }
    .x { border:0; background:transparent; color:#9aa0a6; font-size:22px; cursor:pointer }
    .player { position:relative; aspect-ratio:16/9; background:#000 }
    .player video { width:100%; height:100% }
    .player .controls { position:absolute; inset:auto 12px 12px 12px; display:flex; gap:10px }
    section { margin:36px 0 0 }
    .sec-title { font-size:18px; margin:16px 0 8px; color:#cbd5e1 }
    .muted-hint { font-size:12px; color:#9aa0a6 }
    .tile:focus-within { outline:2px solid var(--accent); outline-offset:2px }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Moving Pictures â€” Virtual Gallery</h1>
        <div class="note">Hover any tile to preview silently. Click to view with sound. iPad: tap once to load/play, use lightbox for audio.</div>
      </div>
      <div class="controls">
        <a class="btn" href="#" onclick="location.reload();return false;">â†» Refresh</a>
      </div>
    </header>

    <section>
      <div class="sec-title">Series â€” Starter</div>
      <div class="gallery">
        <article class="tile" tabindex="0" data-title="Xavier's Perspectives" data-video="assets/xaviers-perspectives.mp4" data-poster="assets/xaviers-perspectives-poster.png">
          <img class="thumb" alt="Poster: Xavier's Perspectives" src="assets/xaviers-perspectives-poster.png" loading="lazy" />
          <video class="clip" preload="none" playsinline muted loop></video>
          <div class="overlay">
            <div class="title">Xavier's Perspectives</div>
            <div class="badge">Hover to preview</div>
          </div>
        </article>
      </div>
      <div class="muted-hint">Tip: Keep preview clips short for faster loads (6â€“10s). Full versions play in lightbox.</div>
    </section>

    <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-label="Video player">
      <div class="lightbox-card">
        <div class="lightbox-head">
          <div class="lightbox-title" id="lbTitle">Title</div>
          <button class="x" id="lbClose" aria-label="Close">âœ•</button>
        </div>
        <div class="player">
          <video id="lbVideo" controls playsinline></video>
          <div class="controls">
            <button class="btn" id="lbMute">ðŸ”Š Toggle Mute</button>
            <button class="btn" id="lbLoop">âˆž Toggle Loop</button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // Hover-to-Preview (muted)
  const tiles = document.querySelectorAll('.tile');
  function loadAndPlayPreview(tile) {{
    const v = tile.querySelector('video.clip');
    if (!v.src) v.src = tile.dataset.video;
    v.currentTime = 0;
    v.play().catch(()=>{{}});
  }}
  function pausePreview(tile) {{
    const v = tile.querySelector('video.clip');
    if (v) {{ v.pause(); v.currentTime = 0; }}
  }}
  tiles.forEach(tile => {{
    tile.addEventListener('mouseenter', () => loadAndPlayPreview(tile));
    tile.addEventListener('focus', () => loadAndPlayPreview(tile));
    tile.addEventListener('mouseleave', () => pausePreview(tile));
    tile.addEventListener('blur', () => pausePreview(tile));
  }});

  // Lightbox with sound
  const lb = document.getElementById('lightbox');
  const lbVideo = document.getElementById('lbVideo');
  const lbTitle = document.getElementById('lbTitle');
  const lbClose = document.getElementById('lbClose');
  const lbMute = document.getElementById('lbMute');
  const lbLoop = document.getElementById('lbLoop');

  function openLightbox(title, src, poster) {{
    lbTitle.textContent = title || 'Untitled';
    lbVideo.src = src; lbVideo.poster = poster || '';
    lb.classList.add('open');
    lbVideo.muted = false; lbVideo.loop = false;
    lbVideo.play().catch(()=>{{}});
  }}
  function closeLightbox() {{ lbVideo.pause(); lbVideo.src = ''; lb.classList.remove('open'); }}
  lbClose.addEventListener('click', closeLightbox);
  lb.addEventListener('click', (e) => {{ if (e.target === lb) closeLightbox(); }});
  document.addEventListener('keydown', (e) => {{ if (e.key === 'Escape' && lb.classList.contains('open')) closeLightbox(); }});
  lbMute.addEventListener('click', () => {{ lbVideo.muted = !lbVideo.muted; }});
  lbLoop.addEventListener('click', () => {{ lbVideo.loop = !lbVideo.loop; }});

  tiles.forEach(tile => {{
    tile.addEventListener('click', () => openLightbox(tile.dataset.title, tile.dataset.video, tile.querySelector('img.thumb')?.src));
    tile.addEventListener('keyup', (e) => {{ if (e.key === 'Enter' || e.key === ' ') openLightbox(tile.dataset.title, tile.dataset.video, tile.querySelector('img.thumb')?.src); }});
  }});
</script>
</body>
</html>
